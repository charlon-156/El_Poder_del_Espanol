var widget=function(){"use strict";var ue=Object.defineProperty,ge=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var X=(g,l,u)=>l in g?ue(g,l,{enumerable:!0,configurable:!0,writable:!0,value:u}):g[l]=u,h=(g,l)=>{for(var u in l||(l={}))pe.call(l,u)&&X(g,u,l[u]);if(j)for(var u of j(l))he.call(l,u)&&X(g,u,l[u]);return g},K=(g,l)=>ge(g,fe(l));const g=()=>{const n=document.querySelector("[data-gyg-partner-id]");if(n)return n.getAttribute("data-gyg-partner-id")},l=()=>{let n="";const t=document.querySelector("[data-gyg-widget]");return t&&(n=t.dataset.gygPartnerId,n||([,,,n]=document.querySelector("[data-gyg-widget]").dataset.gygHref.split("/"))),n},u=()=>{let n="";const t=document.querySelector('script[src*="getyourguide.com/v2/core"]');if(t){const e=t.attributes.onload.value.split("'"),r=e.findIndex(o=>o==="partnerId");n=e[r+2]}return n},J=()=>{const n=g();if(n)return n;const t=l();if(t)return t;const e=u();return e||null},z=(n,t=null)=>{const e=document.getElementsByTagName("head")[0],r=document.createElement("script");r.async=!0,r.src=n,t&&(r.setAttribute("data-gyg-partner-id",t),r.setAttribute("data-gyg-script-origin","widget")),e==null||e.appendChild(r)},Z=n=>{const t="https://widget.getyourguide.com/dist/pa.umd.production.min.js";!document.querySelector(`script[src*="${t}"]`)&&!["getyourguide","gygdev.gygtest","localhost","127.0.0.1","wp-admin"].some(o=>n.location.hostname.includes(o))&&z(t,n.GYG.partnerHash)},Q=(n,t)=>{if(!n||!t)return;const e=n.parentElement;e.style.height=`${t}px`},_="data-gyg-widget-rendered",tt=n=>{n.hasAttribute(_)||n.setAttribute(_,`${Date.now()}`)},et=n=>{window.addEventListener("message",t=>n(t),!1)},nt=n=>{const{height:t=0,widgetContext:e=null,channel:r=null,name:o=null}=n.data;if(r==="GYG"&&o){const i=document.querySelector(`iframe[name="${o}"]`);if(!i)return;if(Q(i,t),tt(i),e&&Object.prototype.hasOwnProperty.call(e,"hasWidgetContext")&&!e.hasWidgetContext){const a=i.parentElement,c=new URL(i.src).searchParams.get("q");a.sendContext(h({q:c},e))}}};var v,rt=new Uint8Array(16);function ot(){if(!v&&(v=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!v))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return v(rt)}var it=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function L(n){return typeof n=="string"&&it.test(n)}for(var d=[],R=0;R<256;++R)d.push((R+256).toString(16).substr(1));function N(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=(d[n[t+0]]+d[n[t+1]]+d[n[t+2]]+d[n[t+3]]+"-"+d[n[t+4]]+d[n[t+5]]+"-"+d[n[t+6]]+d[n[t+7]]+"-"+d[n[t+8]]+d[n[t+9]]+"-"+d[n[t+10]]+d[n[t+11]]+d[n[t+12]]+d[n[t+13]]+d[n[t+14]]+d[n[t+15]]).toLowerCase();if(!L(e))throw TypeError("Stringified UUID is invalid");return e}function at(n){if(!L(n))throw TypeError("Invalid UUID");var t,e=new Uint8Array(16);return e[0]=(t=parseInt(n.slice(0,8),16))>>>24,e[1]=t>>>16&255,e[2]=t>>>8&255,e[3]=t&255,e[4]=(t=parseInt(n.slice(9,13),16))>>>8,e[5]=t&255,e[6]=(t=parseInt(n.slice(14,18),16))>>>8,e[7]=t&255,e[8]=(t=parseInt(n.slice(19,23),16))>>>8,e[9]=t&255,e[10]=(t=parseInt(n.slice(24,36),16))/1099511627776&255,e[11]=t/4294967296&255,e[12]=t>>>24&255,e[13]=t>>>16&255,e[14]=t>>>8&255,e[15]=t&255,e}function st(n){n=unescape(encodeURIComponent(n));for(var t=[],e=0;e<n.length;++e)t.push(n.charCodeAt(e));return t}var ct="6ba7b810-9dad-11d1-80b4-00c04fd430c8",dt="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function lt(n,t,e){function r(o,i,a,c){if(typeof o=="string"&&(o=st(o)),typeof i=="string"&&(i=at(i)),i.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+o.length);if(s.set(i),s.set(o,i.length),s=e(s),s[6]=s[6]&15|t,s[8]=s[8]&63|128,a){c=c||0;for(var f=0;f<16;++f)a[c+f]=s[f];return a}return N(s)}try{r.name=n}catch{}return r.DNS=ct,r.URL=dt,r}function M(n,t,e){n=n||{};var r=n.random||(n.rng||ot)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){e=e||0;for(var o=0;o<16;++o)t[e+o]=r[o];return t}return N(r)}function ut(n,t,e,r){switch(n){case 0:return t&e^~t&r;case 1:return t^e^r;case 2:return t&e^t&r^e&r;case 3:return t^e^r}}function D(n,t){return n<<t|n>>>32-t}function gt(n){var t=[1518500249,1859775393,2400959708,3395469782],e=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof n=="string"){var r=unescape(encodeURIComponent(n));n=[];for(var o=0;o<r.length;++o)n.push(r.charCodeAt(o))}else Array.isArray(n)||(n=Array.prototype.slice.call(n));n.push(128);for(var i=n.length/4+2,a=Math.ceil(i/16),c=new Array(a),s=0;s<a;++s){for(var f=new Uint32Array(16),p=0;p<16;++p)f[p]=n[s*64+p*4]<<24|n[s*64+p*4+1]<<16|n[s*64+p*4+2]<<8|n[s*64+p*4+3];c[s]=f}c[a-1][14]=(n.length-1)*8/Math.pow(2,32),c[a-1][14]=Math.floor(c[a-1][14]),c[a-1][15]=(n.length-1)*8&4294967295;for(var x=0;x<a;++x){for(var m=new Uint32Array(80),w=0;w<16;++w)m[w]=c[x][w];for(var y=16;y<80;++y)m[y]=D(m[y-3]^m[y-8]^m[y-14]^m[y-16],1);for(var I=e[0],T=e[1],S=e[2],G=e[3],U=e[4],P=0;P<80;++P){var k=Math.floor(P/20),le=D(I,5)+ut(k,T,S,G)+U+t[k]+m[P]>>>0;U=G,G=S,S=D(T,30)>>>0,T=I,I=le}e[0]=e[0]+I>>>0,e[1]=e[1]+T>>>0,e[2]=e[2]+S>>>0,e[3]=e[3]+G>>>0,e[4]=e[4]+U>>>0}return[e[0]>>24&255,e[0]>>16&255,e[0]>>8&255,e[0]&255,e[1]>>24&255,e[1]>>16&255,e[1]>>8&255,e[1]&255,e[2]>>24&255,e[2]>>16&255,e[2]>>8&255,e[2]&255,e[3]>>24&255,e[3]>>16&255,e[3]>>8&255,e[3]&255,e[4]>>24&255,e[4]>>16&255,e[4]>>8&255,e[4]&255]}var ft=lt("v5",80,gt),pt=ft;const ht="https://widget.getyourguide.com",b="https://widget.getyourguide.com",mt=`${b}/default/activities.frame`,yt=`${b}/default/activities-auto.frame`,wt=`${ht}/widget-context`,At=`${b}/auto-widget-context`,xt=`${b}/_gnikcart`,Y=n=>(Object.prototype.hasOwnProperty.call(n,"GYG")||(n.GYG=n.GYG||{}),n.GYG.visitorIdPromise||(n.GYG.visitorIdPromise=fetch(xt,{credentials:"include"}).then(t=>t.json()).catch(()=>{const t=M().replace(/-/g,"").toUpperCase().substring(0,32);n.GYG.visitorIdPromise=Promise.resolve({visitor_id:t})})),n.GYG.visitorIdPromise),vt=()=>{let n=!0;const t=document.querySelector("[data-gyg-load-ia]");return t&&(n=t.dataset.gygLoadIa!=="0"),n};class H{constructor(){this.createdAttribute="data-gyg-widget-created"}scrape(t){const e=Array.from(t.querySelectorAll("[data-gyg-widget]"));return e==null?void 0:e.filter(r=>!r.getAttribute(this.createdAttribute))}markElement(t){t.setAttribute(this.createdAttribute,Date.now().toString())}refreshWidgets(t){return Array.from(t.querySelectorAll(`[${this.createdAttribute}]`)).forEach(r=>{const o=r.querySelector("iframe");r.removeChild(o),r.removeAttribute(this.createdAttribute)})}async build({el:t,attributes:e}){const{visitor_id:r}=await window.GYG.visitorIdPromise,o=this.buildUrl(e,r),i=this.createIframe(o);t.appendChild(i)}buildUrl(t,e){let r=t.href;r.includes("/activites.frame")&&(r=r.replace("/activites.frame","/activities.frame")),delete t.href;const o=Object.keys(t).map(a=>`${encodeURIComponent(a)}=${encodeURIComponent(t[a])}`).join("&"),i=encodeURIComponent(window.location.href);return`${r}?${o}&website=${i}&visitor_id=${e}`}createIframe(t){const e=document.createElement("iframe"),r=~t.indexOf("http")?t:`https:${t}`;return e.setAttribute("src",r),e.setAttribute("name",`GYG-${M()}`),e.setAttribute("frameborder","0"),e.setAttribute("scrolling","no"),e.setAttribute("title","GetYourGuide Widget"),e.style.border="none",e.style.position="relative",e.style.visibility="visible",e.style.display="block",e.style.margin="0",e.style.padding="0",e.style.width="100%",e.style.height="100%",e}}const bt=(n,...t)=>{window.GYG.debug&&console.info(`%c[CL][${n}]`,"color: aqua; font-weight: bold;",...t)},Ct=["H2","H3","H4"],Et=20,It=1e3,Tt=500,St=2e3,Gt=["http","img","function","typeof","ajax","javascript","document.","html","px;","color:","div-","css","display:","window.","visibility:"],$=n=>Ct.includes(n),O=n=>{let t="";if(n.tagName==="IMG"){const r=n.getAttribute("ALT");r&&(t+=r+" ")}for(const r of n.getElementsByTagName("IMG")){const o=r.getAttribute("ALT");o&&(t+=o+" ")}return t},W=n=>{let t="";return n&&(B(n)||(t=n)),t},Pt=(n,t,e)=>t.tagName==="BODY"||e===Et||!A(n),A=n=>{const t=n.content,e=n.hasAlreadyPassedFirstHeader;return!t||t.length<Tt&&e||t.length<It&&!e},B=n=>Gt.some(t=>n.includes(t)),C=n=>n?n.replace(/(<([^>]+)>)/gi,"").replace(/(?:https?|ftp):\/\/[\n\S]+/g,"").replace(/(\r\n|\n|\r)/gm,"").replace(/([\u00a0\t])/g," ").replace(/ +/g," ").trim().slice(0,St):null,Rt="5742218a-b6de-4ca2-8e9f-31b9c223125e";async function Dt(n){return pt(n,Rt)}function Ht(n){var e,r,o,i;const t={p:(e=n.paragraph)!=null?e:"",h:(r=n.sectionHeading)!=null?r:"",m:(o=n.metaDescription)!=null?o:"",t:(i=n.metaTitle)!=null?i:""};return Dt(JSON.stringify(t))}function Ot({target:n}){return new Ut({target:n})}function Wt({target:n}){return new _t({target:n})}class q{constructor({target:t}){this.target=t,this.sentPayload=!1,this.payload={language:this.getLanguage,metaTitle:this.getMetaTitle,metaDescription:this.getMetaDescription,sectionHeading:this.getPreviousHeaderContent,paragraph:this.scrapeBlogPostContent,url:window.location.href},bt("PageContext",this.payload),this.target.sendContext=this.sendContext.bind(this)}async getSha(){return Ht(this.payload)}get getLanguage(){return document.documentElement.lang||null}get getMetaTitle(){return C(document.title)}get getMetaDescription(){const t=document.querySelector("meta[name=description]");return t&&t.content?C(t.content):null}get getPreviousHeaderContent(){let t=null,e=this.target.previousElementSibling;for(;e;)$(e.tagName)?(t=e.textContent,e=null):e=e.previousElementSibling;return C(t)}get scrapeBlogPostContent(){const t=this.scrapeUpSideContentInsideWidgetContext();return A(t)&&this.scrapeDownSideContentInsideWidgetContext(t),A(t)&&this.scrapeUpSideContentOutsideWidgetContext(t),C(t.content)}scrapeUpSideContentInsideWidgetContext(){const t=this.target.textContent,e=t===null?"":t;let r=B(e)?"":e,o=this.target.previousElementSibling,i=!1;for(;o;){const a=$(o.tagName);if(o.tagName==="BODY"||!A({hasAlreadyPassedFirstHeader:i||a,content:r})){o=null;break}else!i&&a?i=!0:(r=O(o)+" "+r,r=W(o.textContent)+" "+r);o=o.previousElementSibling}return{content:r,hasAlreadyPassedFirstHeader:i}}scrapeDownSideContentInsideWidgetContext(t){let e=this.target.nextElementSibling;for(;e;)if(!A(t))e=null;else{const r=O(e);t.content=t.content+" "+r;const o=W(e.textContent);t.content=t.content+" "+o,e=e.nextElementSibling}}scrapeUpSideContentOutsideWidgetContext(t){let e=this.target.parentElement,r=0;for(;e&&!Pt(t,e,r);){let o=e.previousElementSibling;for(;o;){const i=W(o.textContent);t.content=i+" "+t.content;const a=O(o);t.content=a+" "+t.content,o=o.previousElementSibling}e=e.parentElement,++r}}}class Ut extends q{sendContext(t){if(!t.q)return;const e=new Blob([JSON.stringify(h(h({},this.payload),t))],{type:"text/plain"});navigator.sendBeacon&&!this.sentPayload&&(navigator.sendBeacon(wt,e),this.sentPayload=!0)}}class _t extends q{sendContext(t){const e=new Blob([JSON.stringify(h(h({},this.payload),t))],{type:"text/plain"});navigator.sendBeacon&&!this.sentPayload&&(navigator.sendBeacon(At,e),this.sentPayload=!0)}}const Lt=n=>n.split(/(?=[A-Z])/).join("_").toLowerCase(),Nt=n=>n.split(/(?=[A-Z])/).join("-").toLowerCase();function Mt(n){return Object.keys(n.dataset).filter(t=>t.indexOf("gyg")!==-1).reduce((t,e)=>{const r=Lt(Yt(e));return K(h({},t),{[r]:n.dataset[e]})},{})}function Yt(n){return n.slice(3)}function $t(n){return n.getAttribute("data-gyg-widget")==="auto"}async function Bt(n){const t=await n.getSha(),e=window.GYG.partnerHash;return h({sha:t,href:yt},e?{partner_id:e}:{})}class qt extends H{constructor(t){super(),this.els=t,this.start()}start(){document.readyState==="complete"?this.generateWidgets(document):window.addEventListener("DOMContentLoaded",()=>{this.generateWidgets(document)}),setInterval(()=>{document.readyState==="complete"&&this.generateWidgets(document)},1e3)}async generateWidgets(t){const e=this.scrape(t);this.els.push(...e);for(const r of e){this.markElement(r);const o=Mt(r);if($t(r)){const i=Wt({target:r}),a=await Bt(i);this.build({el:r,attributes:h(h({},o),a)})}else Ot({target:r}),this.build({el:r,attributes:o})}}}class Ft extends H{constructor(t,e,r){super(),this.els=t,this.convertOptionsToDataAttributes(e,r)}convertOptionsToDataAttributes(t,e){t.setAttribute("data-gyg-href",mt),t.setAttribute("data-gyg-widget","activities");for(const[r,o]of Object.entries(e))t.setAttribute(`data-gyg-${Nt(r)}`,o)}}const Vt=.8,kt=1.5,jt=2,Xt=75,Kt=600,Jt=12,zt=12,Zt=2,Qt=2e3;function te(n,t){const e=window.getComputedStyle(n);e.maxWidth!=="none"&&(t.style.maxWidth=e.maxWidth,t.style.marginLeft="auto",t.style.marginRight="auto")}function ee(n){if(!n)return!1;const t=[...n.children];for(const e of t){const r=window.getComputedStyle(e);if(r.float!=="none"&&r.float!=="")return!0}return!1}function ne(n,t){const e=[...document.querySelectorAll("[data-gyg-widget]")],r=n.getBoundingClientRect();for(const o of e){const i=o.getBoundingClientRect();if(Math.abs(i.top-r.bottom)<t||Math.abs(i.bottom-r.top)+r.height<t)return!0}return!1}function re(){const n=[...document.querySelectorAll("div > p")],[t,e]=[window.innerHeight,window.innerWidth],r=Math.min(e*Vt,Kt),o=n.filter(c=>{const s=c.getBoundingClientRect(),f=s.height>Xt,p=s.width>r,x=s.bottom+window.scrollY>t*kt,m=!ee(c.parentElement),w=!ne(c,t*jt);return p&&f&&x&&m&&w});if(o.length===0)return null;let i=o[0],a=i.getBoundingClientRect().bottom;for(const c of o){const s=c.getBoundingClientRect().bottom;s<a&&(i=c,a=s)}return i}function oe(){const n=document.createElement("div");n.setAttribute("data-gyg-widget","auto"),n.style.marginTop=`${Jt}px`,n.style.marginBottom=`${zt}px`;const t=E("data-gyg-global-excluded-keywords");t&&n.setAttribute("data-gyg-excluded-keywords",t);const e=E("data-gyg-global-cmp");return e&&n.setAttribute("data-gyg-cmp",e),n}function ie(){const n=document.querySelectorAll("[data-gyg-widget]").length,t=E("data-gyg-global-auto-insert-limit");let e=Zt;return t&&(e=parseInt(t,10)),e-n}function ae(){const n=oe(),t=re();t&&(te(t,n),t.after(n))}function se(){const n=F("data-gyg-global-excluded-host-urls");if(n){const t=window.location.pathname;for(const e of n)if(t===e)return!0}return!1}function ce(){const n=F("data-gyg-global-allowed-host-path-prefixes");if(n){const e=window.location.pathname;for(const r of n)if(e.startsWith(r))return!0;return!1}const t=E("data-gyg-global-allowed-host-css-selector");return t?!!document.querySelector(t):!0}function F(n){const t=document.querySelector(`[${n}]`);if(t){const e=t.getAttribute(n);if(e)return e.split(",").map(r=>r.trim())}return null}function E(n){const t=document.querySelector(`[${n}]`);if(t){const e=t.getAttribute(n);if(e)return e.trim()}return null}function V(){const n=!!document.querySelector("[data-gyg-global-auto-insert]"),t=document.readyState==="complete";if(n&&t&&ce()&&!se()){const e=ie();for(let r=0;r<e;r++)ae()}return setTimeout(V,Qt)}function de(){return V()}return(async()=>{if(window.GYG=window.GYG||{},Object.prototype.hasOwnProperty.call(window.GYG,"Widget"))return;window.GYG.debug=window.location.search.includes("debug=true")||!1,window.GYG.partnerHash=J(),window.GYG.els=window.GYG.els||[],et(nt),window.GYG.Widget=async(t,e)=>{await Y(window),new Ft(window.GYG.els,t,e)},window.GYG.refresh=()=>{class t extends H{}new t().refreshWidgets(document)},await Y(window),new qt(window.GYG.els),vt()&&Z(window),de()})()}();
